<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title><%= &title || 'RplusMgmt' %></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Rplus Management">
    <meta name="author" content="Alexander Orlenko">

    % my $bootstrap_ver = '3.0.1';
    % my $role = session->{'user'}->{'role'};

    <!-- Bootstrap -->
    <link rel="stylesheet" href="<%= $assets_url %>/bootstrap/<%= $bootstrap_ver %>/css/bootstrap.min.css">
    <!-- Pines Notify -->
    <link rel="stylesheet" href="<%= $assets_url %>/pnotify/1.2.2/jquery.pnotify.default.css">

    <style type="text/css">
      body {
        padding-top: 70px;
        padding-bottom: 50px;
      }

      .margin-bottom-10 {
        margin-bottom: 10px;
      }

      .margin-bottom-15 {
        margin-bottom: 15px;
      }

      .margin-bottom-20 {
        margin-bottom: 20px;
      }

      textarea {
        max-width: 100%;
      }

      .list-group.list-compact > .list-group-item {
        padding-top: 5px ;
        padding-bottom: 5px;
        border-left: 0;
        border-right: 0;
        border-radius: 0;
      }

      .list-group.list-compact > .list-group-item:first-of-type {
        border-top: 0;
      }

      .list-group.list-compact > .list-group-item:last-of-type {
        border-bottom: 0;
      }

      % if ($self->req->headers->user_agent =~ /Windows/) {
        ::-webkit-scrollbar {
          width: 5px;
        }

        ::-webkit-scrollbar-track {
          margin: 2px;
          /* set the style/colour of the scroll bar background */
          background:
          -webkit-gradient(
            linear,
            0 0,
            100% 0,
            from(rgba(0,0,0,0.2)),
            to(rgba(0,0,0,0.12))
          );
          -webkit-box-shadow: 0 1px 0 0 rgba(255,255,255,0.35);
          -webkit-border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
          /* this is the acutal scrooll bar, set the colours here to match your site */
          /* I have used grey's (#464646 & #383838 & #cccccc) */
          background: rgba(0,0,0,.5);
          -webkit-border-radius: 6px;
          -webkit-background-clip: padding-box;
        }
      % }

      .animation-rotate {
        -webkit-animation: spin 2s infinite linear;
                animation: spin 2s infinite linear;
      }

      @-webkit-keyframes spin {
        0% {
          -webkit-transform: rotate(0deg);
        }
        100% {
          -webkit-transform: rotate(359deg);
        }
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(359deg);
        }
      }

      .geo-map {
        cursor: default !important;
      }

      .geo-map:active {
        cursor: -webkit-grab !important;
      }

      .ui-pnotify.stack-bottomright {
        /* These are just CSS default values to reset the pnotify CSS. */
        right: auto;
        top: auto;
      }
    </style>

    <%= content_for 'header' %>
  </head>
  <body>

    <!-- Navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-top-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a href="/" class="navbar-brand">RplusMgmt</a>
        </div>

        <div class="collapse navbar-collapse navbar-top-collapse">
          <ul class="nav navbar-nav">
            % if ($role eq 'dispatcher' || $role eq 'manager') {
            <li role="presentation" class="<%= $controller eq 'search' && 'active' %>"><a href="/search"><span class="glyphicon glyphicon-search"></span> Search</a></li>
            % }
            % if ($role ne 'dispatcher') {
            <li role="presentation" class="<%= $controller eq 'realty' && 'active' %>"><a href="/realty"><span class="glyphicon glyphicon-home"></span> Realty</a></li>
            % }
            <!--li class="<%= $controller eq 'tasks' && 'active' %>"><a href="/tasks"><span class="glyphicon glyphicon-tasks"></span> Tasks</a></li-->
            % if ($role eq 'manager') {
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-star"></span> Services <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li role="presentation"><a href="/clients"><span class="glyphicon glyphicon-user"></span> Clients</a></li>
                <li role="presentation" class="divider"></li>
                <li role="presentation"><a href="/service/export"><span class="glyphicon glyphicon-export"></span> Export Media</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-stats"></span> Analytics <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li role="presentation"><a href="/analytics/subscriptions"><span class="glyphicon glyphicon-list-alt"></span> Subscriptions</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-cog"></span> Configuration <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li role="presentation"><a href="/conf/mediators"><span class="glyphicon glyphicon-ban-circle"></span> Mediators</a></li>
                <li role="presentation"><a href="/conf/landmarks"><span class="glyphicon glyphicon-globe"></span> Landmarks</a></li>
                <li role="presentation"><a href="/conf/users"><span class="glyphicon glyphicon-user"></span> Users</a></li>
              </ul>
            </li>
            % }
          </ul>
          <p class="navbar-text navbar-right visible-lg">
            Signed in as <a href="/signout" class="navbar-link"><%= session->{'user'}->{'name'} %></a>
          </p>
        </div>
      </div>
    </nav>

    <div class="container">
      <%= content %>

      <!-- Modal Definitions -->
      <%= content_for 'modals' %>
    </div>

    <!-- JavaScript -->
    <script type="application/javascript" src="<%= $assets_url %>/jquery/2.0.3/jquery-2.0.3.min.js"></script>
    <%= content_for 'before_bootstrap' %>
    <!-- Bootstrap -->
    <script type="application/javascript" src="<%= $assets_url %>/bootstrap/<%= $bootstrap_ver %>/js/bootstrap.min.js"></script>
    <!-- MomentJS -->
    <script type="application/javascript" src="<%= $assets_url %>/moment/2.2.1/moment.min.js"></script>
    <!-- HolderJS -->
    <script type="application/javascript" src="<%= $assets_url %>/holder/2.2.0/holder.min.js"></script>
    <!-- Pines Notify -->
    <script type="application/javascript" src="<%= $assets_url %>/pnotify/1.2.2/jquery.pnotify.js"></script>
    <%= content_for 'after_bootstrap' %>

    <%= include 'javascript/rplus' %>

    <%= content_for 'javascript' %>

    <script type="application/javascript">
      $(function () {
        $(document).on('click', 'a[href="#"]', function (event) { event.preventDefault(); });
      });
    </script>
  </body>
</html>
